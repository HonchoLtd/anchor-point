<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Watermark</title>
    <style>
        #watermark{
            display: flex;
            justify-content: center;
            align-items:center;
            flex-direction: column;
            background-color: "black";
            width: 100%;
            height: calc(100vh - 16px);
        }
        .anchor-header, .anchor-footer{
            display:flex;
            justify-content:center;
            align-items: center;
            flex-direction: row;
            width: 100%;
            height: 100px;
            gap: 20px;
        }
        .anchor-point{
            width: 5px;
            height: 5px;
            border-radius:5px;
            border: 1px solid #8D8D8D;
            cursor: pointer;
        }
        
    </style>
</head>
<body>
        <div id="watermark">
            <div class="anchor-header">
                <div class="portrait" onclick="changeOrientation('portrait');" style="width: 10px;height: 15px;border: 1px solid #FFFFFF;cursor: pointer;"></div>
                <div class="landscape" onclick="changeOrientation('landscape');" style="width: 17.78px;height: 10px;border: 1px solid #8D8D8D;cursor: pointer;"></div>
                <div class="square" onclick="changeOrientation('square');" style="width: 15px;height: 15px;border: 1px solid #8D8D8D;cursor: pointer;"></div>
                <select id="ratio">
                    <option value="">Ratio</option>
                    <option value="1:1">1:1</option>
                    <option value="2:3">2:3</option>
                    <option value="9:16">9:16</option>
                    <option value="3:2">3:2</option>
                    <option value="16:9">16:9</option>
                </select>
                <button type="button" onClick="changeTheme()" >theme</button>
            </div>
            <div class="anchor-body">
                <canvas id="ubersnap-watermark"></canvas>
            </div>
            <div class="anchor-footer">
                <input id="sticker-data" type="file" style="display: none" accept="image/*">
                <button id="upload-button">upload</button>
                <button id="costum" onclick="setScale('custom')">custom</button>
                <button id="fit" onclick="setScale('fit')">fit</button>
                <button id="fill" onclick="setScale('fill')">fill</button>
                <div style="width: 30px;height: 30px;display: flex;justify-content:center;align-items:center;gap: 2px;flex-wrap: wrap;">
                    <div id="top-left" class="anchor-point"></div>
                    <div id="top-center" class="anchor-point"></div>
                    <div id="top-right" class="anchor-point"></div>
                    <div id="middle-left" class="anchor-point"></div>
                    <div id="middle-center" class="anchor-point"></div>
                    <div id="middle-right" class="anchor-point"></div>
                    <div id="bottom-left" class="anchor-point"></div>
                    <div id="bottom-center" class="anchor-point"></div>
                    <div id="bottom-right" class="anchor-point"></div>
                </div>
            </div>
        </div>

<script src="dist/index.js"></script>
<script>
  const watermark = new WatermarkSticker();
  const headerClass = ["portrait","landscape","square"];
  const anchorPoint = document.querySelectorAll(".anchor-point");
  const Position = ["top-left","top-center","top-right","middle-left","middle-center","middle-right","bottom-left","bottom-center","bottom-right"]
  let image;
  var theme = false;
  let activeWhite = "#FFFFFF";
  let activeBlack = "#000000";
  let inactive = "#8D8D8D";
  let orientation = "portrait"
  document.addEventListener("anchor-point", function(event) {
            const position = event.detail.position;
            resetPositionColor()
            if(!theme){
            document.getElementById(position).style.borderColor = activeBlack;
            document.getElementById(position).style.backgroundColor = activeBlack;
        }else{
            document.getElementById(position).style.borderColor = activeWhite;
            document.getElementById(position).style.backgroundColor = activeWhite;
        }
        });
  function setScale(val){
    watermark.setScaleSticker({scale:val})
  }
  Position.map(val=>{
    document.getElementById(val).addEventListener("click",function(){
        watermark.setPositionSticker({position:val})
        resetPositionColor()
        if(!theme){
            document.getElementById(val).style.borderColor = activeBlack;
            document.getElementById(val).style.backgroundColor = activeBlack;
        }else{
            document.getElementById(val).style.borderColor = activeWhite;
            document.getElementById(val).style.backgroundColor = activeWhite;
        }
    })
  })
  function resetPositionColor(){
            anchorPoint.forEach((data) => {
                data.style.borderColor = inactive;
                data.style.backgroundColor = inactive;
            });
  }
  function changeOrientation(value){
      this.orientation = value
      const selectElement = document.getElementById("ratio");
      selectElement.selectedIndex = 0;
      let val = this.theme ? activeWhite : activeBlack;
        if(value=="portrait"){
            watermark.setCanvasSize(300,450)
            document.getElementsByClassName("portrait")[0].style.borderColor = val;
            document.getElementsByClassName("landscape")[0].style.borderColor = inactive;
            document.getElementsByClassName("square")[0].style.borderColor = inactive;
        }else if(value=="landscape"){
            watermark.setCanvasSize(800,450)
            document.getElementsByClassName("portrait")[0].style.borderColor = inactive;
            document.getElementsByClassName("landscape")[0].style.borderColor = val;
            document.getElementsByClassName("square")[0].style.borderColor = inactive;
        }else if(value=="square"){
            watermark.setCanvasSize(450,450)
            document.getElementsByClassName("portrait")[0].style.borderColor = inactive;
            document.getElementsByClassName("landscape")[0].style.borderColor = inactive;
            document.getElementsByClassName("square")[0].style.borderColor = val;
        }
    }

        document.getElementById("ratio").addEventListener("change",function(e){
            if(e.target.value === "1:1"){
                watermark.setCanvasSize(450,450)
            }else if(e.target.value === "2:3"){
                watermark.setCanvasSize(300,450)
            }else if(e.target.value === "9:16"){
                watermark.setCanvasSize(253.13,450)
            }else if(e.target.value === "3:2"){
                watermark.setCanvasSize(450,300)
            }else if(e.target.value === "16:9"){
                watermark.setCanvasSize(450,253.13)
            }else{
                watermark.setCanvasSize(300,450)
            }
        })
    

    function changeTheme(){
        this.theme = !theme;
        const position = watermark.position;
        if(!this.theme){
            headerClass.map(data=>{
                document.getElementsByClassName(data)[0].style.borderColor = activeBlack
            })
            resetPositionColor()
            document.getElementById(position.position).style.borderColor = activeBlack;
            document.getElementById(position.position).style.backgroundColor = activeBlack;
            document.getElementById("watermark").style.backgroundColor="white"
            watermark.setBackgroundColor(activeWhite)
            watermark.setBorderColor(inactive)
            changeOrientation(this.orientation)
        }else{
            headerClass.map(data=>{
                document.getElementsByClassName(data)[0].style.borderColor = inactive
            })
            resetPositionColor()
            document.getElementById(position.position).style.borderColor = activeWhite;
            document.getElementById(position.position).style.backgroundColor = activeWhite;
            document.getElementById("watermark").style.backgroundColor="black"
            watermark.setBackgroundColor(activeBlack)
            watermark.setBorderColor(inactive)
            changeOrientation(this.orientation)
        }
    }
    changeTheme()
    // document.getElementsByClassName("portrait")[0].style.borderColor =activeWhite;

    // Function to trigger the file input
  function triggerFileInput() {
    document.getElementById("sticker-data").click();
  }

  // Function to handle the file selection
  document.getElementById("sticker-data").addEventListener("change", function (event) {
    const fileInput = event.target;
    if (fileInput.files.length > 0) {
        const selectedFile = fileInput.files[0];
        
        // Create a new Image object
        const image = new Image();
        image.src = URL.createObjectURL(selectedFile);
        
        // Set an event listener to load the image when it's loaded
        image.onload = function() { 
            this.image = image
            watermark.setStickerData(image,image.width,image.height)
        };
        
        // Load the selected file into the Image object
      // You can access the selected file here and perform further actions, such as uploading it to a server.
    }
  });

  // Add a click event listener to the "Upload" button to trigger the file input
  document.getElementById("upload-button").addEventListener("click", triggerFileInput);

</script>
</body>
</html>
